using Microsoft.CodeAnalysis;

namespace Thinktecture.CodeAnalysis;

public abstract class ThinktectureSourceGeneratorBase
{
   private readonly string? _generatedFileSuffix;

   protected ThinktectureSourceGeneratorBase(string? generatedFileSuffix)
   {
      _generatedFileSuffix = generatedFileSuffix;
   }

   protected void EmitFile(SourceProductionContext context, string? typeNamespace, string typeName, string? generatedCode)
   {
      if (!String.IsNullOrWhiteSpace(generatedCode))
      {
         context.AddSource($"{(typeNamespace is null ? null : $"{typeNamespace}.")}{typeName}{_generatedFileSuffix}.g.cs", $@"// <auto-generated />
#nullable enable
{generatedCode}");
      }
   }
}
